"use strict";define(["jquery","base64","template","text!../tql/reading.html"],function(r,e,o,a){var t,n=window.localStorage,c=n.getItem("list")||1,i=n.getItem("fontSize")||16,s=n.getItem("color")||"#fff";function d(){r.ajax({url:"/book/read?activing="+c,dataType:"json",success:function(e){var t,n;t=e,(n=document.createElement("script")).src=t.jsonp,document.head.appendChild(n),window.duokan_fiction_chapter=function(e){var t=JSON.parse(r.base64().decode(e));r(".reader__content").html(""),o(a,t,".reader__content"),document.head.removeChild(n)}}})}d(),r(".reader__content").on("click",function(){r(".reader").addClass("reader_op")}),r(".reader__mask").on("click",function(){r(".reader").removeClass("reader_op-font"),r(".reader").removeClass("reader_op")}),r(".reader__ft-font").on("click",function(){r(".reader").toggleClass("reader_op-font")}),r(".reader__ft-night").on("click",function(){0==r(".reader").attr("data-night")?(r(".reader__content").css("background","#000"),r(".reader").attr("data-night",1)):(r(".reader__content").css("background",s),r(".reader").attr("data-night",0))}),r(".reader__content").css("font-size",i+"px"),r(".reader__font-large").on("click",function(){21<=++i&&(i=21),r(".reader__content").css("font-size",i+"px"),n.setItem("fontSize",i)}),r(".reader__font-small").on("click",function(){i<=11&&(i=11),i--,r(".reader__content").css("font-size",i+"px"),n.setItem("fontSize",i)}),r.ajax({url:"/book/reading",dataType:"json",success:function(e){t=e.item.toc.length,r("#Tag__79").html(c+"/"+t),o(r(".menulist").html(),e.item.toc,".fiction-toc")}}),r(".reader__ft-toc").on("click",function(){r(".text2").addClass("show")}),r(".top__back").on("click",function(){r(".text2").removeClass("show")}),r(".fiction-toc").on("click","li",function(){c=r(this).index(),r(".text2").removeClass("show"),r("#Tag__79").html(c+"/"+t),n.setItem("list",c),d()}),r(".reader__prev-chapter").on("click",function(){if(--c<=0)return!1;r("#Tag__79").html(c+"/"+t),n.setItem("list",c),d()}),r(".reader__next-chapter").on("click",function(){if(4<++c)return!1;r("#Tag__79").html(c+"/"+t),n.setItem("list",c),d()}),r(".reader__content").css("background",s),r(".reader__font-bg").on("click","a",function(){var e=r(this).css("background");r(".reader__content").css("background",e),n.setItem("color",e)})});